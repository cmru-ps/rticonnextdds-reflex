<?xml version="1.0"?>
<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../resource/schema/rti_queuing_service.xsd">

    <qos_library name="HelloWorldQS_Library">
        <qos_profile name="HelloWorldQS_Profile"
            base_name="BuiltinQosLibExp::Generic.StrictReliable.HighThroughput"
            is_default_qos="true">
            <participant_qos>
             <transport_builtin>
                  <mask>UDPv4</mask>
             </transport_builtin> 
             <discovery_config>
                <initial_participant_announcements>10000</initial_participant_announcements>
                <min_initial_participant_announcement_period>
                   <sec>0</sec>
                   <nanosec>100000000</nanosec>
                </min_initial_participant_announcement_period>
            </discovery_config>

            </participant_qos>
            <datawriter_qos>
              <resource_limits>
                <max_samples>512</max_samples>
              </resource_limits>
              <batch>
                <enable>false</enable>
              </batch>
              <reliability>
                <max_blocking_time>
                  <sec>1</sec>
                  <nanosec>0</nanosec>
                </max_blocking_time>
              </reliability>
              <writer_resource_limits>
                <max_remote_reader_filters>100</max_remote_reader_filters>
              </writer_resource_limits>
              <protocol>
                <rtps_reliable_writer>
                  <max_heartbeat_retries>LENGTH_UNLIMITED</max_heartbeat_retries>
                  <min_nack_response_delay>
                    <sec>DURATION_ZERO_SEC</sec>
                    <nanosec>DURATION_ZERO_NSEC</nanosec>
                  </min_nack_response_delay>
                  <max_nack_response_delay>
                    <sec>DURATION_ZERO_SEC</sec>
                    <nanosec>DURATION_ZERO_NSEC</nanosec>
                  </max_nack_response_delay>
                </rtps_reliable_writer>
              </protocol>
            </datawriter_qos>
            <datareader_qos>
              <resource_limits>
                <max_samples>512</max_samples>
              </resource_limits>
            </datareader_qos>
        </qos_profile>
    </qos_library>

    <queuing_service name="QsPerf">
        <domain_participant name="DomainParticipant">
            <domain_id>21</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>

                <shared_reader_queue session="Session"
                    name="SharedReaderQueue">
                    <topic_name>PerfHelloWorldTopic</topic_name>
                    <type_name>PerfHelloWorld</type_name>


                    <datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

                    <datareader_qos base_name="HelloWorldQS_Library::HelloWorldQS_Profile" /> 


                    <queue_qos>
                        <resource_limits>
                            <replacement_policy>
                              <kind>WAIT_WITHOUT_REPLACEMENT</kind>
                            </replacement_policy>
                            <queue_allocation_settings>
                                <max_count>1000</max_count>
                            </queue_allocation_settings>
                        </resource_limits>
                        <distribution>
                            <kind>ROUND_ROBIN</kind>
                            <property>
                                <value>
                                    <element>
                                        <name>UNACKED_THRESHOLD</name>
                                        <value>512</value>
                                    </element>
                                </value>
                            </property>
                        </distribution>
                        <reliability>
   			      <app_ack_sample_to_producer>0</app_ack_sample_to_producer>
                        </reliability>
                        <redelivery>
                            <max_delivery_retries>6
                            </max_delivery_retries>
                            <response_timeout>
                                <duration>
                                    <sec>300</sec>
                                    <nanosec>0</nanosec>
                                </duration>
                            </response_timeout>
                        </redelivery>
 			<lifespan>
		            <duration>
		               <sec>DURATION_INFINITE_SEC</sec>
			       <nanosec>0</nanosec>
		            </duration>
		        </lifespan>
                    </queue_qos>
                </shared_reader_queue>
            </shared_subscriber>
        </domain_participant>
    </queuing_service>



    <queuing_service name="HelloWorldQSWithReply">
        <domain_participant name="DomainParticipant">
            <domain_id>0</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>

                <shared_reader_queue session="Session"
                    name="SharedReaderQueue">
                    <topic_name>HelloWorldTopic</topic_name>
                    <type_name>requestType</type_name>
		    <reply_topic>HelloWorldTopicReply</reply_topic>
                    <reply_type>replyType</reply_type>
 


                    <datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

                    <datareader_qos base_name="HelloWorldQS_Library::HelloWorldQS_Profile" /> 


                    <queue_qos>
                        <resource_limits>
                          <queue_allocation_settings>
                            <max_count>250000</max_count>
                          </queue_allocation_settings>
                        </resource_limits>
                        <distribution>
                            <kind>ROUND_ROBIN</kind>
                            <property>
                                <value>
                                    <element>
                                        <name>UNACKED_THRESHOLD</name>
                                        <value>5</value>
                                    </element>
                                </value>
                            </property>
                        </distribution>
                        <reliability>
   			      <app_ack_sample_to_producer>1</app_ack_sample_to_producer>
                        </reliability>
                        <redelivery>
                            <max_delivery_retries>6
                            </max_delivery_retries>
                            <response_timeout>
                                <duration>
                                    <sec>300</sec>
                                    <nanosec>0</nanosec>
                                </duration>
                            </response_timeout>
                        </redelivery>
 			<lifespan>
		            <duration>
		               <sec>DURATION_INFINITE_SEC</sec>   
			       <nanosec>0</nanosec>
		            </duration>
		        </lifespan>
                    </queue_qos>
                </shared_reader_queue>
            </shared_subscriber>
        </domain_participant>
    </queuing_service>



    <queuing_service name="HelloWorldQSPersistence">
        <persistence_settings>
            <filesystem>
                <journal_mode>WAL</journal_mode>
                <synchronization>OFF</synchronization>
                <vacuum>FULL</vacuum>
            </filesystem>
        </persistence_settings>

        <domain_participant name="DomainParticipant">
            <domain_id>0</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>

                <shared_reader_queue session="Session"
                    name="SharedReaderQueue">
                    <topic_name>HelloWorldTopic</topic_name>
                    <type_name>HelloWorld</type_name>

                    <datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <queue_qos>
                        <persistence>
                            <kind>PERSISTENT</kind>
                        </persistence>
                        <resource_limits>
                            <queue_allocation_settings>
                                <max_count>10000</max_count>
                            </queue_allocation_settings>
                        </resource_limits>
                        <distribution>
                            <kind>ROUND_ROBIN</kind>
                            <property>
                                <value>
                                    <element>
                                        <name>UNACKED_THRESHOLD</name>
                                        <value>5</value>
                                    </element>
                                </value>
                            </property>
                        </distribution>
                        <reliability>
                            <app_ack_sample_to_producer>1
                            </app_ack_sample_to_producer>
                        </reliability>
                        <redelivery>
                            <max_delivery_retries>6
                            </max_delivery_retries>
                            <response_timeout>
                                <duration>
                                    <sec>300</sec>
                                    <nanosec>0</nanosec>
                                </duration>
                            </response_timeout>
                        </redelivery>
 			<lifespan>
		            <duration>
		               <sec>DURATION_INFINITE_SEC</sec>   
			       <nanosec>0</nanosec>
		            </duration>
		        </lifespan>
                    </queue_qos>
                </shared_reader_queue>
            </shared_subscriber>
        </domain_participant>
    </queuing_service>

    <queuing_service name="HelloWorldQSReplication">
        <replication_settings>
            <queue_instances>3</queue_instances>
            <synchronize_consumer_assignment>false
            </synchronize_consumer_assignment>
            <master_timeout>
                <sec>3</sec>
                <nanosec>0</nanosec>
            </master_timeout>
        </replication_settings>

        <service_qos>
            <shared_reader_queue_replication>
                <enabled>true</enabled>
            </shared_reader_queue_replication>
        </service_qos>

        <domain_participant name="DomainParticipant">
            <domain_id>0</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>

                <shared_reader_queue session="Session"
                    name="SharedReaderQueue">
                     <topic_name>HelloWorldTopic</topic_name>
                     <type_name>requestType</type_name>
 
                    <datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <update_datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile">
                        <resource_limits>
                            <max_samples>50</max_samples>
                            <initial_samples>50</initial_samples>
                        </resource_limits>
                    </update_datawriter_qos>
                    <update_datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <redistribution_datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

                    <queue_qos>
                        <resource_limits>
                            <queue_allocation_settings>
                                <max_count>25000</max_count>
                            </queue_allocation_settings>
                        </resource_limits>
                        <distribution>
                            <kind>ROUND_ROBIN</kind>
                            <property>
                                <value>
                                    <element>
                                        <name>UNACKED_THRESHOLD</name>
                                        <value>5</value>
                                    </element>
                                </value>
                            </property>
                        </distribution>
                        <reliability>
                            <app_ack_sample_to_producer>1
                            </app_ack_sample_to_producer>
                        </reliability>
                        <redelivery>
                            <max_delivery_retries>6
                            </max_delivery_retries>
                            <response_timeout>
                                <duration>
                                    <sec>300</sec>
                                    <nanosec>0</nanosec>
                                </duration>
                            </response_timeout>
                        </redelivery>
 			<lifespan>
		            <duration>
		               <sec>DURATION_INFINITE_SEC</sec>   
			       <nanosec>0</nanosec>
		            </duration>
		        </lifespan>
                    </queue_qos>
                </shared_reader_queue>
            </shared_subscriber>
        </domain_participant>
    </queuing_service>
















    <queuing_service name="HelloWorldQSReplicationWithReply">
        <replication_settings>
            <queue_instances>3</queue_instances>
            <synchronize_consumer_assignment>false
            </synchronize_consumer_assignment>
            <master_timeout>
                <sec>3</sec>
                <nanosec>0</nanosec>
            </master_timeout>
        </replication_settings>

        <service_qos>
            <shared_reader_queue_replication>
                <enabled>true</enabled>
            </shared_reader_queue_replication>
        </service_qos>

        <domain_participant name="DomainParticipant">
            <domain_id>0</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>

                <shared_reader_queue session="Session"
                    name="SharedReaderQueue">
                     <topic_name>HelloWorldTopic</topic_name>
                     <type_name>requestType</type_name>
		     <reply_topic>HelloWorldTopicReply</reply_topic>
                     <reply_type>replyType</reply_type>
 
                    <datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <update_datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile">
                        <resource_limits>
                            <max_samples>50</max_samples>
                            <initial_samples>50</initial_samples>
                        </resource_limits>
                    </update_datawriter_qos>
                    <update_datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <redistribution_datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

                    <queue_qos>
                        <resource_limits>
                            <queue_allocation_settings>
                                <max_count>25000</max_count>
                            </queue_allocation_settings>
                        </resource_limits>
                        <distribution>
                            <kind>ROUND_ROBIN</kind>
                            <property>
                                <value>
                                    <element>
                                        <name>UNACKED_THRESHOLD</name>
                                        <value>5</value>
                                    </element>
                                </value>
                            </property>
                        </distribution>
                        <reliability>
                            <app_ack_sample_to_producer>1
                            </app_ack_sample_to_producer>
                        </reliability>
                        <redelivery>
                            <max_delivery_retries>6
                            </max_delivery_retries>
                            <response_timeout>
                                <duration>
                                    <sec>300</sec>
                                    <nanosec>0</nanosec>
                                </duration>
                            </response_timeout>
                        </redelivery>
 			<lifespan>
		            <duration>
		               <sec>DURATION_INFINITE_SEC</sec>   
			       <nanosec>0</nanosec>
		            </duration>
		        </lifespan>
                    </queue_qos>
                </shared_reader_queue>
            </shared_subscriber>
        </domain_participant>
    </queuing_service>










    <queuing_service name="HelloWorldQSPersistenceReplication">
        <persistence_settings>
            <filesystem>
                <journal_mode>WAL</journal_mode>
                <synchronization>OFF</synchronization>
                <vacuum>FULL</vacuum>
            </filesystem>
        </persistence_settings>

        <replication_settings>
            <queue_instances>2</queue_instances>
            <synchronize_consumer_assignment>false
            </synchronize_consumer_assignment>
            <master_timeout>
                <sec>3</sec>
                <nanosec>0</nanosec>
            </master_timeout>
        </replication_settings>

        <service_qos>
            <shared_reader_queue_replication>
                <enabled>true</enabled>
            </shared_reader_queue_replication>
        </service_qos>

        <domain_participant name="DomainParticipant">
            <domain_id>0</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>

                <shared_reader_queue session="Session"
                    name="SharedReaderQueue">
                    <topic_name>HelloWorldTopic</topic_name>
                    <type_name>HelloWorld</type_name>

                    <datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
                    <update_datawriter_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile">
                        <resource_limits>
                            <max_samples>50</max_samples>
                            <initial_samples>50</initial_samples>
                        </resource_limits>
                    </update_datawriter_qos>
                    <update_datareader_qos
                        base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

                    <queue_qos>
                        <persistence>
                            <kind>PERSISTENT</kind>
                        </persistence>
                        <resource_limits>
                            <queue_allocation_settings>
                                <max_count>10000</max_count>
                            </queue_allocation_settings>
                        </resource_limits>
                        <distribution>
                            <kind>ROUND_ROBIN</kind>
                            <property>
                                <value>
                                    <element>
                                        <name>UNACKED_THRESHOLD</name>
                                        <value>5</value>
                                    </element>
                                </value>
                            </property>
                        </distribution>
                        <reliability>
                            <app_ack_sample_to_producer>1
                            </app_ack_sample_to_producer>
                        </reliability>
                        <redelivery>
                            <max_delivery_retries>6
                            </max_delivery_retries>
                            <response_timeout>
                                <duration>
                                    <sec>300</sec>
                                    <nanosec>0</nanosec>
                                </duration>
                            </response_timeout>
                        </redelivery>
 			<lifespan>
		            <duration>
		               <sec>DURATION_INFINITE_SEC</sec>   
			       <nanosec>0</nanosec>
		            </duration>
		        </lifespan>
                    </queue_qos>
                </shared_reader_queue>
            </shared_subscriber>
        </domain_participant>
    </queuing_service>

    <!-- Example that shows how to enable remote administration. This Queing 
        Service contains only one shared subscriber that is empty. Through remote 
        commands, new queues can be added to the existing shared subscriber. -->
    <queuing_service name="RemoteConfigQS">
        <administration>
            <domain_id>1</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />
        </administration>

        <domain_participant name="DomainParticipant">
            <domain_id>0</domain_id>
            <participant_qos
                base_name="HelloWorldQS_Library::HelloWorldQS_Profile" />

            <!-- Empty shared subscriber with only one session. -->
            <shared_subscriber name="SharedSubscriber">
                <session_settings>
                    <session name="Session" />
                </session_settings>
            </shared_subscriber>

        </domain_participant>
    </queuing_service>

</dds>
